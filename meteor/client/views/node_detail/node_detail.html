<!--
~ Copyright 2015 Concept
~
~ Licensed under the Apache License, Version 2.0 (the "License");
~ you may not use this file except in compliance with the License.
~ You may obtain a copy of the License at
~
~ http://www.apache.org/licenses/LICENSE-2.0
~
~ Unless required by applicable law or agreed to in writing, software
~ distributed under the License is distributed on an "AS IS" BASIS,
~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
~ See the License for the specific language governing permissions and
~ limitations under the License.
-->

<!--
Edit information about a reference.
-->
<template name="NodeDetail">
  {{#if $eq node.nodeType "chapter"}}
  <h3>Rediger kapittelelement</h3>
  {{else}}
    <h3>Rediger Informasjonselement</h3>
  {{/if}}

  {{#autoForm collection="GV.collections.Nodes" id="update-node-form" doc=node type="update"}}
		{{> afQuickField name="title" }}

    {{#if $eq node.nodeType "chapter"}}
      {{> afQuickField name="description" rows="6" placeholder="Sammendrag" label="Sammendrag"}}
    {{else}}
  		{{> afQuickField name="description" rows="6" }}
  		{{> afQuickField name="tags" options=getTagsOptions}}

      <div class="row" style="margin-bottom:20px;">
        <div class="col-xs-12">
          <div class="row" style="margin-bottom:20px;">
            <div class="col-xs-12">
              {{!-- Upload process status --}}
              {{#with file}}
                  {{#if this.isUploaded}}
                    <b><a href="#" class="download">{{this.name}}</a></b> er opplastet og lagt ved referansen.
                    <button type="button" class="btn btn-danger btn-xs delete-file">Slett</button>
                  {{else}}

                    Laster opp <b>{{this.name}}</b>...

                    {{> FS.UploadProgressBar bootstrap=true class='progress-bar-success progress-bar-striped active' showPercent=true}}

                    {{#unless uploadStopped}}
                      <button type="button" class="btn btn-info pull-right stop-upload">Stopp opplastning</button>
                    {{else}}
                      <button type="button" class="btn btn-info pull-right resume-upload">Fortsett opplastning</button>
                    {{/unless}}
                  {{/if}}
              {{/with}}
            </div>
          </div>
          {{!-- Upload field --}}
          {{#unless file}}
            <div class="upload-field">
              <span><span class="glyphicon glyphicon-upload" style="margin-right:5px;"></span> Klikk for å laste opp fil</span>
              <input class="file-upload pull-left" type="file">
            </div>
          {{else}}
            {{#if uploadStopped}}
            <div class="upload-field">
              <span>Klikk for å bytte fil</span>
              <input class="file-upload pull-left" type="file">
            </div>
            {{/if}}
          {{/unless}}

        </div>
      </div>
    {{/if}}

    <div class="form-group">
      {{#if $eq node.nodeType "chapter"}}
		    <button type="button" class="btn btn-danger pull-left delete-chapter-node">Slett kapittelelement</button>
      {{else}}
        <button type="button" class="btn btn-danger pull-left delete-media-node">Slett informasjonselement</button>
      {{/if}}
			<button type="submit" class="btn btn-primary pull-right {{#if file}}{{#unless uploadStopped}}{{#unless file.isUploaded}}disabled{{/unless}}{{/unless}}{{/if}}">Lagre</button>
			<button type="button" class="btn btn-default pull-right cancel" style="margin-right:10px;">Avbryt</button>
		</div>
	{{/autoForm}}
</template>

<!--
Edit top level information about a document. This is basically the root node.
-->
<template name="GeneralInfo">
	<h3>Generelt om dokumentet</h3>
  <p><em>Denne noden beskriver dokumentet i sin helhet. Denne informasjonen brukes for å lett kunne finne dokumentet ved en seinere anledning.</em></p>

	{{#autoForm collection="GV.collections.Documents" id="update-document-form" doc=this type="update"}}
		{{> afQuickField name="title" }}
		{{> afQuickField name="summary" rows="6" }}

		<div class="form-group">
			<button type="button" class="btn btn-danger pull-left delete-document">Slett hele dokumentet</button>
			<button type="submit" class="btn btn-primary pull-right">Lagre</button>
			<button type="button" class="btn btn-default pull-right cancel" style="margin-right:10px;">Avbryt</button>
		</div>
	{{/autoForm}}
</template>
