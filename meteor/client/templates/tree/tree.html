<!--
~ Copyright 2015 Concept
~
~ Licensed under the Apache License, Version 2.0 (the "License");
~ you may not use this file except in compliance with the License.
~ You may obtain a copy of the License at
~
~ http://www.apache.org/licenses/LICENSE-2.0
~
~ Unless required by applicable law or agreed to in writing, software
~ distributed under the License is distributed on an "AS IS" BASIS,
~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
~ See the License for the specific language governing permissions and
~ limitations under the License.
-->

<!--
The tree constructor template.
-->
<template name="Tree">
  <div class="structure-header">

    <div class="pull-right btn-group" role="group">
      <button aria-expanded="false" class="btn btn-default dropdown-toggle menu-button" data-toggle="dropdown" type="button">
      <span class="glyphicon glyphicon-option-horizontal"></span></button>

      <ul class="dropdown-menu" role="menu">
        {{#unless isTemplate}}
          <li>
            <a class="toggle-media-nodes" href="#">
              {{#if $.Session.equals "showMediaNodes" true}}
                <span class="glyphicon glyphicon-eye-close"></span> Skjul informasjonselementer
              {{else}}
                <span class="glyphicon glyphicon-eye-open"></span> Vis informasjonselementer
              {{/if}}
            </a>
          </li>
          <li role="presentation" class="divider"></li>

          <li role="presentation"><a role="menuitem" tabindex="-1" href="#" class="add-media-node"><span class="glyphicon glyphicon-plus" aria-hidden="true"></span> Opprett informasjonselement</a></li>
        {{/unless}}

        <li role="presentation"><a role="menuitem" tabindex="-1" href="#" class="add-chapter-node"><span class="glyphicon glyphicon-plus" aria-hidden="true"></span> Opprett kapittelelement</a></li>

        <li role="presentation" class="divider"></li>

        <li><a href="#" class="expand-nodes"><span class="glyphicon glyphicon-resize-full"></span> Utvid alle elementer</a></li>
        <li><a href="#" class="collapse-nodes"><span class="glyphicon glyphicon-resize-small"></span> Sammentrekk alle elementer</a></li>

        <li role="presentation" class="divider"></li>

        <li role="presentation"><a role="menuitem" tabindex="-1" href="#" class="generate-pdf"><span class="glyphicon glyphicon-print" aria-hidden="true"></span> Generer utskriftsdokument</a></li>
        <li role="presentation"><a role="menuitem" tabindex="-1" href="#" class="export-to-file"><span class="glyphicon glyphicon-export" aria-hidden="true"></span> Eksporter til fil</a></li>

        <li role="presentation" class="divider"></li>

        <li><a href="#" class="help-modal-button"><span class="glyphicon glyphicon-question-sign"></span> Hjelp</a></li>
      </ul>
    </div>

    <h4 class="header-text">
      <span class="glyphicon glyphicon-tree-conifer" style="font-size:15px; margin: 0 5px;"></span> Kapittelstruktur
    </h4>
  </div>

  {{!-- Start of tree / the root node --}}
  <div id="{{id}}" class="tree structure disable-select {{class}}">
  	<ul>
  		<li class="node root" style="margin-top:0;" data-id="{{guid}}">
        <span draggable="true" class="element root">
          <span class="glyphicon glyphicon-book"></span> {{documentTitle}} ({{childrenCount}})
        </span>

        {{!-- Render rest of the visible nodes --}}
  			{{#each treeItems}}
  				{{> NodeLevel getContext}}
  			{{/each}}
      </li>
    </ul>
  </div>
</template>

<!--
Help modal for tree view.
-->
<template name="TreeHelp">
  Klikk og dra nodene i trestrukturen der du vil ha dem. Klikker man dobbelt på en av nodene, så åpnes det en fane til høyre med den valgte informasjonen. Ved bruk av enkeltklikk på nodene, åpnes bare fanen midlertidig.
</template>

<!--
Popover to confirm when trying to move media nodes to another chapter node.
-->
<template name="MovePopover">
  <div class="popover confirmation fade top in" style="display: block; top: {{$.Session.get 'movePopoverY'}}; left: {{$.Session.get 'movePopoverX'}};">
    <div class="arrow"></div>
    <h3 class="popover-title">Flytte elementene hit?</h3>
    <div class="popover-content text-center">
      <div class="btn-group"><a class="btn btn-xs btn-primary apply-move" ><i class="glyphicon glyphicon-ok"></i> Ok</a><a class="btn btn-xs btn-default dismiss-move"><i class="glyphicon glyphicon-remove"></i> Avbryt</a>
      </div>
    </div>
  </div>
</template>
